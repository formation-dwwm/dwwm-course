<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/dwwm-course/styles.893dda305735dd4af666.css" id="gatsby-global-css">h3{margin-top:50px!important}details>summary{cursor:pointer}details>summary:after{content:"v";float:right;font-family:monospace;font-weight:800;font-size:20px}pre{background:rgb(42 42 42)!important}html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:112.5%/1.45em georgia,serif;box-sizing:border-box;overflow-y:scroll}*,:after,:before{box-sizing:inherit}body{color:rgba(0,0,0,.8);font-family:Roboto,georgia,serif;font-weight:400;word-wrap:break-word;-webkit-font-kerning:normal;font-kerning:normal;-ms-font-feature-settings:"kern","liga","clig","calt";font-feature-settings:"kern","liga","clig","calt"}img{max-width:100%;padding:0;margin:0 0 1.45rem}h1{font-size:2.25rem}h1,h2{padding:0;margin:0 0 1.45rem;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h2{font-size:1.62671rem}h3{font-size:1.38316rem}h3,h4{padding:0;margin:0 0 1.45rem;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h4{font-size:1rem}h5{font-size:.85028rem}h5,h6{padding:0;margin:0 0 1.45rem;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h6{font-size:.78405rem}hgroup{padding:0;margin:0 0 1.45rem}ol,ul{padding:0;margin:0 0 1.45rem 1.45rem;list-style-position:outside;list-style-image:none}dd,dl,figure,p{padding:0;margin:0 0 1.45rem}pre{margin:0 0 1.45rem;font-size:.85rem;line-height:1.42;background:rgba(0,0,0,.04);border-radius:3px;overflow:auto;word-wrap:normal;padding:1.45rem}table{font-size:1rem;line-height:1.45rem;border-collapse:collapse;width:100%}fieldset,table{padding:0;margin:0 0 1.45rem}blockquote{padding:0;margin:0 1.45rem 1.45rem}form,iframe,noscript{padding:0;margin:0 0 1.45rem}hr{padding:0;margin:0 0 calc(1.45rem - 1px);background:rgba(0,0,0,.2);border:none;height:1px}address{padding:0;margin:0 0 1.45rem}b,dt,strong,th{font-weight:700}li{margin-bottom:.725rem}ol li,ul li{padding-left:0}li>ol,li>ul{margin-left:1.45rem;margin-bottom:.725rem;margin-top:.725rem}blockquote :last-child,li :last-child,p :last-child{margin-bottom:0}li>p{margin-bottom:.725rem}code,kbd,samp{font-size:.85rem;line-height:1.45rem}abbr,abbr[title],acronym{border-bottom:1px dotted rgba(0,0,0,.5);cursor:help}abbr[title]{text-decoration:none}td,th,thead{text-align:left}td,th{border-bottom:1px solid rgba(0,0,0,.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding:.725rem .96667rem calc(.725rem - 1px)}td:first-child,th:first-child{padding-left:0}td:last-child,th:last-child{padding-right:0}code,tt{background-color:rgba(0,0,0,.04);border-radius:3px;font-family:SFMono-Regular,Consolas,Roboto Mono,Droid Sans Mono,Liberation Mono,Menlo,Courier,monospace;padding:.2em 0}pre code{background:none;line-height:1.42}code:after,code:before,tt:after,tt:before{letter-spacing:-.2em;content:" "}pre code:after,pre code:before,pre tt:after,pre tt:before{content:""}@media only screen and (max-width:480px){html{font-size:100%}}</style><meta name="generator" content="Gatsby 2.32.11"/><link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="/dwwm-course/static/webfonts/s/roboto/v27/KFOlCnqEu92Fr1MmSU5fBBc4.woff2"/><link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="/dwwm-course/static/webfonts/s/roboto/v27/KFOmCnqEu92Fr1Mu4mxK.woff2"/><link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="/dwwm-course/static/webfonts/s/roboto/v27/KFOlCnqEu92Fr1MmEU9fBBc4.woff2"/><style>@font-face{font-family:Roboto;font-style:normal;font-weight:300;src:url(/dwwm-course/static/webfonts/s/roboto/v27/KFOlCnqEu92Fr1MmSU5fBBc4.woff2) format("woff2");font-display:swap}@font-face{font-family:Roboto;font-style:normal;font-weight:400;src:url(/dwwm-course/static/webfonts/s/roboto/v27/KFOmCnqEu92Fr1Mu4mxK.woff2) format("woff2");font-display:swap}@font-face{font-family:Roboto;font-style:normal;font-weight:500;src:url(/dwwm-course/static/webfonts/s/roboto/v27/KFOlCnqEu92Fr1MmEU9fBBc4.woff2) format("woff2");font-display:swap}@font-face{font-family:Roboto;font-style:normal;font-weight:300;src:url(/dwwm-course/static/webfonts/s/roboto/v27/KFOlCnqEu92Fr1MmSU5fBBc-.woff) format("woff");font-display:swap}@font-face{font-family:Roboto;font-style:normal;font-weight:400;src:url(/dwwm-course/static/webfonts/s/roboto/v27/KFOmCnqEu92Fr1Mu4mxM.woff) format("woff");font-display:swap}@font-face{font-family:Roboto;font-style:normal;font-weight:500;src:url(/dwwm-course/static/webfonts/s/roboto/v27/KFOlCnqEu92Fr1MmEU9fBBc-.woff) format("woff");font-display:swap}</style><title data-react-helmet="true"></title><link rel="icon" href="/dwwm-course/favicon-32x32.png?v=4a9773549091c227cd2eb82ccd9c5e3a" type="image/png"/><link rel="manifest" href="/dwwm-course/manifest.webmanifest" crossorigin="anonymous"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="48x48" href="/dwwm-course/icons/icon-48x48.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="72x72" href="/dwwm-course/icons/icon-72x72.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="96x96" href="/dwwm-course/icons/icon-96x96.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="144x144" href="/dwwm-course/icons/icon-144x144.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="192x192" href="/dwwm-course/icons/icon-192x192.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="256x256" href="/dwwm-course/icons/icon-256x256.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="384x384" href="/dwwm-course/icons/icon-384x384.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="512x512" href="/dwwm-course/icons/icon-512x512.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link as="script" rel="preload" href="/dwwm-course/webpack-runtime-056163e73162f4b96bd9.js"/><link as="script" rel="preload" href="/dwwm-course/framework-741ade27086b2708e961.js"/><link as="script" rel="preload" href="/dwwm-course/app-aa5785c6be0ea3307b1b.js"/><link as="script" rel="preload" href="/dwwm-course/styles-407fe62976dc5310c43e.js"/><link as="script" rel="preload" href="/dwwm-course/component---src-templates-course-js-dfe45f6ea4c1ec03114a.js"/><link as="fetch" rel="preload" href="/dwwm-course/page-data\courses\PHP\PDO-AJAX\page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/dwwm-course/page-data/sq/d/3649515864.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/dwwm-course/page-data\app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div style="background:rebeccapurple;margin-bottom:1.45rem"><div style="margin:0 auto;max-width:960px;padding:1.45rem 1.0875rem"><h1 style="margin:0"><a style="color:white;text-decoration:none" href="/dwwm-course/">Dev Web Course</a></h1></div></div><div style="margin:0 auto;max-width:960px;padding:0px 1.0875rem 1.45rem;padding-top:0"><div><h1>MySQL, PDO... et AJAX</h1><h3>Objectifs</h3><ul><li>Savoir mettre en oeuvre le middleware PDO avec PHP pour communiquer en CRUD avec un SGBDR</li><li>Savoir décoder l&#x27;objectif précédent</li><li>Connaître et mettre en oeuvre les bonnes pratiques et sécurités lors de l&#x27;utilisation de PDO</li><li>Savoir exploiter la technologie AJAX pour récupérer ou envoyer dynamiquement des données à un SGBDR en passant par un serveur PHP et l&#x27;API que l&#x27;on aura développé</li></ul><p><strong><strong>Durée indicative</strong></strong><br/>
<!-- -->8h</p><p>Fier de vos nouvelles connaissances en PHP, vous savez maintenant mettre en place un serveur dynamique, utiliser un SGBDR et communiquer avec celui-ci. Vous avez ainsi appris à développer des pages web qui exploiteront ces données, et connaissez maintenant les bonnes pratiques PHP ainsi que les architectures MVC.<br/>
<!-- -->Pour compléter ces notions, nous allons maintenant nous pencher d&#x27;autant plus sur l&#x27;utilisation de PDO pour mettre en oeuvre nos composants d&#x27;accès en suivant les bonnes pratiques ainsi que les règles élémentaires de sécurité.<br/>
<!-- -->Nous pourrons ensuite passer un moment pour voir et développer avec une dernière pièce manquante: la technologie AJAX qui permet à un client web de communiquer avec un serveur.</p><h3>PDO et bonnes pratiques</h3><p>Prenez un temps pour lire le document suivant, qui remet en place quelques généralités sur PDO avant de s&#x27;intéresser aux bonnes pratiques et aux notions de sécurité qui entourent son utilisation.  </p><a style="display:block;margin-bottom:10px" target="_blank" href="http://ee0421d80ebc4e9792ad131272c3bf89.testmyurl.ws/resources/PHP/A-Acces-BDD-PDO.pdf">Accéder à une Base de données en langage PHP à l&#x27;aide de PDO</a><p>Vous pourrez ensuite mettre en oeuvre ces notions avec l&#x27;exercice guidé ci-dessous.</p><a style="display:block;margin-bottom:10px" target="_blank" href="http://ee0421d80ebc4e9792ad131272c3bf89.testmyurl.ws/resources/PHP/P-Acces-MySQL-PDO.pdf">Exercices PDO</a><details><summary>Correction</summary><a style="display:block;margin-bottom:10px" target="_blank" href="http://ee0421d80ebc4e9792ad131272c3bf89.testmyurl.ws/resources/PHP/S-Acces-MySQL-PDO.pdf">Correction Exercices PDO</a></details><h3>AJAX</h3><p>AJAX est l&#x27;acronyme de <strong>A</strong>synchrounous <strong>J</strong>avascript <strong>A</strong>nd <strong>X</strong>ML. En Français cela pourrait se traduire par <em>Javascript et XML asynchrones</em>.<br/>
<!-- -->C&#x27;est une technologie fournie par les navigateurs web et permettant aux scripts clients Javascript de communiquer sur le réseau. De ce fait, elle est très souvent associée avec la notion de <em>Web 2.0</em>, car c&#x27;est grâce à celle-ci que l&#x27;on peut récupérer ou envoyer des données sans effectuer de rechargements de page. C&#x27;est cette pièce du web qui a réellement permis la naissance des <em>SPA</em>, ou <strong>S</strong>ingle <strong>P</strong>age <strong>A</strong>pp.  </p><p>Avant tout, deux choses à savoir:<br/>
<!-- -->Le fait qu&#x27;AJAX porte toujours ce nom, et par extension le nom XML, est trompeur. Historiquement AJAX a été développé dans l&#x27;idée d&#x27;utiliser le format XML pour échanger avec un serveur web. Si c&#x27;est bien sûr tout à fait possible, il est beaucoup plus commun maintenant que d&#x27;utiliser cette technologie en combinaison avec le format JSON pour l&#x27;échange de données. On devrait donc quelque part l&#x27;appeler &quot;AJAJ&quot;, même si le nom historique persiste.<br/>
<!-- -->De plus, le terme AJAX présente de multiples synonymes ou termes associés. On parle souvent de <code>XHR</code> ou/pour <code>XMLHttpRequest</code>, qui est l&#x27;unique objet initialement fourni par les navigateurs pour effectuer ces requêtes réseau. Etant peu pratique à l&#x27;utilisation (a minima disons &quot;verbeux&quot;), une implémentation proposée par <code>jQuery</code> et accessible par <code>$.ajax</code> sera aussi souvent trouvée voir confondue. Par extension et adaptation des navigateurs web, la plupart des navigateurs récents (tous) proposent maintenant la fonction <code>fetch</code> pour effectuer ces requêtes asynchrones, dans un paradigme de <code>Promises</code>, <strong>et qui sera maintenant à préférer dans la plupart des cas</strong>. Enfin, diverses librairies proposent des outils plus ou moins avancées pour effectuer ces mêmes requêtes réseau (et utilisent <code>fetch</code> ou <code>XHR</code> en interne). On peut citer <code>axios</code> parmis les plus utilisées, ou encore le <code>HttpClient</code> proposé par le framework <code>Angular</code>.  </p><p>Avant d&#x27;en voir plus par vous même, voici trois exemples minimaux :</p><h4>Hello AJAX</h4><pre><code class="language-html">&lt;!-- index.html --&gt;
&lt;!doctype html&gt;
&lt;html&gt;
    &lt;body&gt;
        &lt;script&gt;
            fetch(&#x27;api.php&#x27;)
                .then(response =&gt; response.text())
                .then(message =&gt; {
                    alert(`Hello ${message}`);
                })
        &lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre><pre><code class="language-php">&lt;?php
// api.php
echo &quot;AJAX&quot;;
</code></pre><h4>AJAX With JSON</h4><pre><code class="language-html">&lt;!-- index.html --&gt;
&lt;!doctype html&gt;
&lt;html&gt;
    &lt;body&gt;
        &lt;ul id=&quot;users-list&quot;&gt;&lt;/ul&gt;
        &lt;script&gt;
            fetch(&#x27;api.php&#x27;)
                .then(response =&gt; response.json())
                .then(users =&gt; {
                    const $list = document.getElementById(&#x27;users-list&#x27;);
                    $list.innerHTML =  users.map(user =&gt; `
                        &lt;li&gt;${user.name}&lt;/li&gt;
                    `).join(&#x27;&#x27;);
                })
        &lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre><pre><code class="language-php">&lt;?php
// api.php
$users = [
    [ &quot;name&quot; =&gt; &quot;Riri&quot; ],
    [ &quot;name&quot; =&gt; &quot;Fifi&quot; ],
    [ &quot;name&quot; =&gt; &quot;Loulou&quot; ]
];
header(&#x27;Content-Type: application/json&#x27;);
echo json_encode($users);
</code></pre><h4>AJAX And POST</h4><pre><code class="language-html">&lt;!-- index.html --&gt;
&lt;!doctype html&gt;
&lt;html&gt;
    &lt;body&gt;
        &lt;script&gt;
            const options = {
                method: &quot;POST&quot;,
                headers: new Headers({
                    &quot;Content-Type&quot;: &quot;application/json&quot;
                }),
                body: JSON.stringify({ username: &quot;root&quot;, password: &quot;&quot; })
            }
            fetch(&#x27;api.php&#x27;, options)
                .then(response =&gt; response.json())
                .then(apiResponse =&gt; {
                    if(apiResponse.success){
                        alert(`Hello ${apiResponse.data.displayName}`);
                    }else{
                        alert(`Error: ${apiResponse.error}`);
                    }
                })
                .catch(error =&gt; alert(&quot;General Error&quot;))
        &lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre><pre><code class="language-php">&lt;?php
// api.php
$json_params = file_get_contents(&quot;php://input&quot;);
$decoded_params = json_decode($json_params, true);

if (strlen($json_params) &gt; 0 &amp;&amp; json_last_error() == JSON_ERROR_NONE){
    $_POST = $decoded_params;
}
  
if(!isset($_POST[&quot;username&quot;]) || !isset($_POST[&quot;password&quot;])){
    sendJsonError(400, &quot;Bad Request&quot;);
}

if($_POST[&quot;username&quot;] === &quot;root&quot; &amp;&amp; $_POST[&quot;password&quot;] === &quot;&quot;){ // O, RLY ?!
    $profile = [ &quot;username&quot; =&gt; &quot;root&quot;, &quot;displayName&quot; =&gt; &quot;admin&quot;, &quot;roles&quot; =&gt; [&quot;ROLE_ADMIN&quot;, &quot;ROLE_USER&quot;]];
    sendJson($profile);
}else{
    sendJsonError(401, &quot;Bad credentials&quot;);
}

function sendJson($data){
    header(&#x27;Content-Type: application/json&#x27;);
    echo json_encode([
        &quot;success&quot; =&gt; true,
        &quot;data&quot; =&gt; $data
    ]);
    die();
}
function sendJsonError($code, $message){
    http_response_code($code);
    header(&#x27;Content-Type: application/json&#x27;);   
    echo json_encode([
        &quot;success&quot; =&gt; false,
        &quot;error&quot; =&gt; $message
    ]);
    die();
}
</code></pre><h3>Mise en oeuvre AJAX</h3><p>Nous vous proposons ici de mettre en oeuvre cette technologie. Plus précisément, il serait intéressant de mettre en place une page web utilisant AJAX pour interroger un serveur PHP, qui lui même communiquera avec un SGBD avant de répondre (en JSON). Soit, le cas typique d&#x27;utilisation d&#x27;AJAX.<br/>
<!-- -->Pour ce faire, nous vous proposons de développer un petit ensemble client-serveur utilisant AJAX pour permettre une recherche textuelle dynamique et réactive, comme on en trouve sur de multiples sites de nos jours.<br/>
<!-- -->Vous pouvez imaginer votre propre implémentation et chercher à la mettre en place, ou vous pouvez vous appuyer sur la vidéo proposée ci-dessous pour un tutoriel guidé. Bonne découverte !  </p><a style="display:block;margin-bottom:10px" target="_blank" href="https://www.youtube.com/watch?v=-v53ly8Zlfc&amp;ab_channel=GTCoding">How To Create Live Search Using PHP and Fetch API from MySQL Database | GTCoding</a></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/courses/PHP/PDO-AJAX";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-2966d4d8fea208fd6f8f.js"],"app":["/app-aa5785c6be0ea3307b1b.js"],"component---src-pages-404-js":["/component---src-pages-404-js-259f4ac87ed407e7efc1.js"],"component---src-pages-index-js":["/component---src-pages-index-js-e7c754136055f611d0c9.js"],"component---src-pages-index-orig-mdx":["/component---src-pages-index-orig-mdx-ab719f1026e6b698f3a0.js"],"component---src-pages-page-2-mdx":["/component---src-pages-page-2-mdx-28413f329e9ca8174ff5.js"],"component---src-templates-course-js":["/component---src-templates-course-js-dfe45f6ea4c1ec03114a.js"]};/*]]>*/</script><script src="/dwwm-course/polyfill-2966d4d8fea208fd6f8f.js" nomodule=""></script><script src="/dwwm-course/component---src-templates-course-js-dfe45f6ea4c1ec03114a.js" async=""></script><script src="/dwwm-course/styles-407fe62976dc5310c43e.js" async=""></script><script src="/dwwm-course/app-aa5785c6be0ea3307b1b.js" async=""></script><script src="/dwwm-course/framework-741ade27086b2708e961.js" async=""></script><script src="/dwwm-course/webpack-runtime-056163e73162f4b96bd9.js" async=""></script></body></html>