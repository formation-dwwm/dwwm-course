{"componentChunkName":"component---src-templates-course-js","path":"/courses/PHP/PDO-AJAX","result":{"data":{"mdx":{"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"MySQL, PDO... et AJAX\",\n  \"order\": 320\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h3\", null, \"Objectifs\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Savoir mettre en oeuvre le middleware PDO avec PHP pour communiquer en CRUD avec un SGBDR\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Savoir d\\xE9coder l'objectif pr\\xE9c\\xE9dent\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Conna\\xEEtre et mettre en oeuvre les bonnes pratiques et s\\xE9curit\\xE9s lors de l'utilisation de PDO\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Savoir exploiter la technologie AJAX pour r\\xE9cup\\xE9rer ou envoyer dynamiquement des donn\\xE9es \\xE0 un SGBDR en passant par un serveur PHP et l'API que l'on aura d\\xE9velopp\\xE9\")), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, mdx(\"strong\", {\n    parentName: \"strong\"\n  }, \"Dur\\xE9e indicative\")), mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"8h\"), mdx(\"p\", null, \"Fier de vos nouvelles connaissances en PHP, vous savez maintenant mettre en place un serveur dynamique, utiliser un SGBDR et communiquer avec celui-ci. Vous avez ainsi appris \\xE0 d\\xE9velopper des pages web qui exploiteront ces donn\\xE9es, et connaissez maintenant les bonnes pratiques PHP ainsi que les architectures MVC.\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"Pour compl\\xE9ter ces notions, nous allons maintenant nous pencher d'autant plus sur l'utilisation de PDO pour mettre en oeuvre nos composants d'acc\\xE8s en suivant les bonnes pratiques ainsi que les r\\xE8gles \\xE9l\\xE9mentaires de s\\xE9curit\\xE9.\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"Nous pourrons ensuite passer un moment pour voir et d\\xE9velopper avec une derni\\xE8re pi\\xE8ce manquante: la technologie AJAX qui permet \\xE0 un client web de communiquer avec un serveur.\"), mdx(\"h3\", null, \"PDO et bonnes pratiques\"), mdx(\"p\", null, \"Prenez un temps pour lire le document suivant, qui remet en place quelques g\\xE9n\\xE9ralit\\xE9s sur PDO avant de s'int\\xE9resser aux bonnes pratiques et aux notions de s\\xE9curit\\xE9 qui entourent son utilisation.  \"), mdx(ExtLink, {\n    src: \"http://ee0421d80ebc4e9792ad131272c3bf89.testmyurl.ws/resources/PHP/A-Acces-BDD-PDO.pdf\",\n    title: \"Acc\\xE9der \\xE0 une Base de donn\\xE9es en langage PHP \\xE0 l'aide de PDO\",\n    mdxType: \"ExtLink\"\n  }), mdx(\"p\", null, \"Vous pourrez ensuite mettre en oeuvre ces notions avec l'exercice guid\\xE9 ci-dessous.\"), mdx(ExtLink, {\n    src: \"http://ee0421d80ebc4e9792ad131272c3bf89.testmyurl.ws/resources/PHP/P-Acces-MySQL-PDO.pdf\",\n    title: \"Exercices PDO\",\n    mdxType: \"ExtLink\"\n  }), mdx(\"details\", null, mdx(\"summary\", null, \"Correction\"), mdx(ExtLink, {\n    src: \"http://ee0421d80ebc4e9792ad131272c3bf89.testmyurl.ws/resources/PHP/S-Acces-MySQL-PDO.pdf\",\n    title: \"Correction Exercices PDO\",\n    mdxType: \"ExtLink\"\n  })), mdx(\"h3\", null, \"AJAX\"), mdx(\"p\", null, \"AJAX est l'acronyme de \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"A\"), \"synchrounous \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"J\"), \"avascript \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"A\"), \"nd \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"X\"), \"ML. En Fran\\xE7ais cela pourrait se traduire par \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"Javascript et XML asynchrones\"), \".\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"C'est une technologie fournie par les navigateurs web et permettant aux scripts clients Javascript de communiquer sur le r\\xE9seau. De ce fait, elle est tr\\xE8s souvent associ\\xE9e avec la notion de \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"Web 2.0\"), \", car c'est gr\\xE2ce \\xE0 celle-ci que l'on peut r\\xE9cup\\xE9rer ou envoyer des donn\\xE9es sans effectuer de rechargements de page. C'est cette pi\\xE8ce du web qui a r\\xE9ellement permis la naissance des \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"SPA\"), \", ou \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"S\"), \"ingle \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"P\"), \"age \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"A\"), \"pp.  \"), mdx(\"p\", null, \"Avant tout, deux choses \\xE0 savoir:\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"Le fait qu'AJAX porte toujours ce nom, et par extension le nom XML, est trompeur. Historiquement AJAX a \\xE9t\\xE9 d\\xE9velopp\\xE9 dans l'id\\xE9e d'utiliser le format XML pour \\xE9changer avec un serveur web. Si c'est bien s\\xFBr tout \\xE0 fait possible, il est beaucoup plus commun maintenant que d'utiliser cette technologie en combinaison avec le format JSON pour l'\\xE9change de donn\\xE9es. On devrait donc quelque part l'appeler \\\"AJAJ\\\", m\\xEAme si le nom historique persiste.\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"De plus, le terme AJAX pr\\xE9sente de multiples synonymes ou termes associ\\xE9s. On parle souvent de \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"XHR\"), \" ou/pour \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"XMLHttpRequest\"), \", qui est l'unique objet initialement fourni par les navigateurs pour effectuer ces requ\\xEAtes r\\xE9seau. Etant peu pratique \\xE0 l'utilisation (a minima disons \\\"verbeux\\\"), une impl\\xE9mentation propos\\xE9e par \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"jQuery\"), \" et accessible par \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"$.ajax\"), \" sera aussi souvent trouv\\xE9e voir confondue. Par extension et adaptation des navigateurs web, la plupart des navigateurs r\\xE9cents (tous) proposent maintenant la fonction \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"fetch\"), \" pour effectuer ces requ\\xEAtes asynchrones, dans un paradigme de \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Promises\"), \", \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"et qui sera maintenant \\xE0 pr\\xE9f\\xE9rer dans la plupart des cas\"), \". Enfin, diverses librairies proposent des outils plus ou moins avanc\\xE9es pour effectuer ces m\\xEAmes requ\\xEAtes r\\xE9seau (et utilisent \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"fetch\"), \" ou \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"XHR\"), \" en interne). On peut citer \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"axios\"), \" parmis les plus utilis\\xE9es, ou encore le \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"HttpClient\"), \" propos\\xE9 par le framework \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Angular\"), \".  \"), mdx(\"p\", null, \"Avant d'en voir plus par vous m\\xEAme, voici trois exemples minimaux :\"), mdx(\"h4\", null, \"Hello AJAX\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-html\"\n  }, \"<!-- index.html -->\\n<!doctype html>\\n<html>\\n    <body>\\n        <script>\\n            fetch('api.php')\\n                .then(response => response.text())\\n                .then(message => {\\n                    alert(`Hello ${message}`);\\n                })\\n        </script>\\n    </body>\\n</html>\\n\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-php\"\n  }, \"<?php\\n// api.php\\necho \\\"AJAX\\\";\\n\")), mdx(\"h4\", null, \"AJAX With JSON\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-html\"\n  }, \"<!-- index.html -->\\n<!doctype html>\\n<html>\\n    <body>\\n        <ul id=\\\"users-list\\\"></ul>\\n        <script>\\n            fetch('api.php')\\n                .then(response => response.json())\\n                .then(users => {\\n                    const $list = document.getElementById('users-list');\\n                    $list.innerHTML =  users.map(user => `\\n                        <li>${user.name}</li>\\n                    `).join('');\\n                })\\n        </script>\\n    </body>\\n</html>\\n\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-php\"\n  }, \"<?php\\n// api.php\\n$users = [\\n    [ \\\"name\\\" => \\\"Riri\\\" ],\\n    [ \\\"name\\\" => \\\"Fifi\\\" ],\\n    [ \\\"name\\\" => \\\"Loulou\\\" ]\\n];\\nheader('Content-Type: application/json');\\necho json_encode($users);\\n\")), mdx(\"h4\", null, \"AJAX And POST\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-html\"\n  }, \"<!-- index.html -->\\n<!doctype html>\\n<html>\\n    <body>\\n        <script>\\n            const options = {\\n                method: \\\"POST\\\",\\n                headers: new Headers({\\n                    \\\"Content-Type\\\": \\\"application/json\\\"\\n                }),\\n                body: JSON.stringify({ username: \\\"root\\\", password: \\\"\\\" })\\n            }\\n            fetch('api.php', options)\\n                .then(response => response.json())\\n                .then(apiResponse => {\\n                    if(apiResponse.success){\\n                        alert(`Hello ${apiResponse.data.displayName}`);\\n                    }else{\\n                        alert(`Error: ${apiResponse.error}`);\\n                    }\\n                })\\n                .catch(error => alert(\\\"General Error\\\"))\\n        </script>\\n    </body>\\n</html>\\n\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-php\"\n  }, \"<?php\\n// api.php\\n$json_params = file_get_contents(\\\"php://input\\\");\\n$decoded_params = json_decode($json_params, true);\\n\\nif (strlen($json_params) > 0 && json_last_error() == JSON_ERROR_NONE){\\n    $_POST = $decoded_params;\\n}\\n  \\nif(!isset($_POST[\\\"username\\\"]) || !isset($_POST[\\\"password\\\"])){\\n    sendJsonError(400, \\\"Bad Request\\\");\\n}\\n\\nif($_POST[\\\"username\\\"] === \\\"root\\\" && $_POST[\\\"password\\\"] === \\\"\\\"){ // O, RLY ?!\\n    $profile = [ \\\"username\\\" => \\\"root\\\", \\\"displayName\\\" => \\\"admin\\\", \\\"roles\\\" => [\\\"ROLE_ADMIN\\\", \\\"ROLE_USER\\\"]];\\n    sendJson($profile);\\n}else{\\n    sendJsonError(401, \\\"Bad credentials\\\");\\n}\\n\\nfunction sendJson($data){\\n    header('Content-Type: application/json');\\n    echo json_encode([\\n        \\\"success\\\" => true,\\n        \\\"data\\\" => $data\\n    ]);\\n    die();\\n}\\nfunction sendJsonError($code, $message){\\n    http_response_code($code);\\n    header('Content-Type: application/json');   \\n    echo json_encode([\\n        \\\"success\\\" => false,\\n        \\\"error\\\" => $message\\n    ]);\\n    die();\\n}\\n\")), mdx(\"h3\", null, \"Mise en oeuvre AJAX\"), mdx(\"p\", null, \"Nous vous proposons ici de mettre en oeuvre cette technologie. Plus pr\\xE9cis\\xE9ment, il serait int\\xE9ressant de mettre en place une page web utilisant AJAX pour interroger un serveur PHP, qui lui m\\xEAme communiquera avec un SGBD avant de r\\xE9pondre (en JSON). Soit, le cas typique d'utilisation d'AJAX.\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"Pour ce faire, nous vous proposons de d\\xE9velopper un petit ensemble client-serveur utilisant AJAX pour permettre une recherche textuelle dynamique et r\\xE9active, comme on en trouve sur de multiples sites de nos jours.\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"Vous pouvez imaginer votre propre impl\\xE9mentation et chercher \\xE0 la mettre en place, ou vous pouvez vous appuyer sur la vid\\xE9o propos\\xE9e ci-dessous pour un tutoriel guid\\xE9. Bonne d\\xE9couverte !  \"), mdx(ExtLink, {\n    src: \"https://www.youtube.com/watch?v=-v53ly8Zlfc&ab_channel=GTCoding\",\n    title: \"How To Create Live Search Using PHP and Fetch API from MySQL Database | GTCoding\",\n    mdxType: \"ExtLink\"\n  }));\n}\n;\nMDXContent.isMDXComponent = true;","frontmatter":{"title":"MySQL, PDO... et AJAX"}}},"pageContext":{"slug":"courses/PHP/PDO-AJAX"}},"staticQueryHashes":["3649515864"]}